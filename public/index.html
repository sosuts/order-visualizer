<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Order Format Editor</title>
    <meta name="description" content="ASTM・HL7検査オーダーフォーマットの構文解析・編集ツール">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🧪</text></svg>">
</head>
<body>
    <header>
        <h1>🧪 Medical Order Format Editor</h1>
        <p>ASTM・HL7検査オーダーフォーマットの構文解析・編集ツール</p>
    </header>

    <main>
        <div class="editor-container">
            <div class="input-section">
                <div class="section-header">
                    <span class="icon">📝</span>
                    <h2>入力データ</h2>
                </div>
                
                <select id="format-selector" aria-label="フォーマット選択">
                    <option value="auto">自動判定</option>
                    <option value="astm">ASTM E1394</option>
                    <option value="hl7">HL7 v2.x</option>
                </select>
                
                <textarea id="order-input" 
                    placeholder="検査オーダーデータを入力してください...&#10;&#10;例 (ASTM):&#10;H|\^&|||LIS|||||||P|E 1394-97|20231201120000&#10;P|1||12345||Smith^John^A||19850315|M...&#10;&#10;例 (HL7):&#10;MSH|^~\&|LIS|HOSPITAL|LAB|HOSPITAL|20231201120000...&#10;PID|1||12345^^^HOSPITAL^MR||Smith^John^A...&#10;&#10;Ctrl + Enter で解析実行"
                    aria-label="検査オーダーデータ入力"
                ></textarea>
                
                <div class="controls">
                    <button id="parse-btn" type="button" aria-label="構文解析実行">
                        ⚡ 構文解析
                    </button>
                    <button id="clear-btn" type="button" aria-label="入力クリア">
                        🗑️ クリア
                    </button>
                    <button id="load-template" type="button" aria-label="テンプレート読み込み">
                        📋 テンプレート
                    </button>
                </div>
            </div>

            <div class="output-section">
                <div class="section-header">
                    <span class="icon">📊</span>
                    <h2>解析結果</h2>
                </div>
                
                <div class="tabs" role="tablist" aria-label="解析結果表示形式">
                    <button class="tab-btn active" data-tab="table" role="tab" aria-selected="true" aria-controls="table-view">
                        📋 表形式
                    </button>
                    <button class="tab-btn" data-tab="json" role="tab" aria-selected="false" aria-controls="json-view">
                        🔗 JSON
                    </button>
                    <button class="tab-btn" data-tab="tree" role="tab" aria-selected="false" aria-controls="tree-view">
                        🌳 構文木
                    </button>
                </div>
                
                <div id="result-container" style="max-width: 100%; width: 100%; overflow: hidden;">
                    <div id="table-view" class="tab-content active" role="tabpanel" aria-labelledby="table-tab">
                        <!-- Dynamic content will be inserted here -->
                    </div>
                    <div id="json-view" class="tab-content" role="tabpanel" aria-labelledby="json-tab" style="overflow: hidden;">
                        <pre id="json-output" aria-label="JSON形式解析結果"></pre>
                    </div>
                    <div id="tree-view" class="tab-content" role="tabpanel" aria-labelledby="tree-tab">
                        <div id="tree-container" aria-label="構文木表示"></div>
                    </div>
                </div>
                
                <div class="export-controls">
                    <button id="export-json" type="button" aria-label="JSON形式でエクスポート">
                        💾 JSON出力
                    </button>
                    <button id="export-text" type="button" aria-label="テキスト形式でエクスポート">
                        📄 テキスト出力
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Load parsers first, then main script -->
    <script src="parsers.js"></script>
    <script src="script.js"></script>
</body>
</html>